<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phân bổ các loại giờ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/html-docx-js@0.3.1/dist/html-docx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto bg-white shadow-md rounded-lg p-6">
        <h1 class="text-2xl font-bold mb-4 text-center">Phân Bổ Các Loại Giờ</h1>

        <!-- Phần nhập liệu -->
        <div class="mb-6">
            <h2 class="text-lg font-semibold mb-2">Thông tin học phần</h2>
            <div class="mb-4">
                <label class="block text-lg font-bold text-gray-700">Số tín chỉ:</label>
                <input type="number" id="totalCredits" min="1" value="1" class="mt-1 block w-full sm:w-1/3 border border-gray-300 rounded-md p-2 text-lg" oninput="updateTable()">
            </div>
            <div class="ml-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Lý thuyết (TC):</label>
                    <input type="number" id="theoryCredits" min="0" value="0" class="mt-1 block w-1/12 border border-gray-300 rounded-md p-2" oninput="updateTable()">
                </div>
                <div class="mt-2">
                    <label class="block text-sm font-medium text-gray-700">TH/TN/TL (TC):</label>
                    <input type="number" id="practicalCredits" min="0" value="0" class="mt-1 block w-1/12 border border-gray-300 rounded-md p-2" oninput="updateTable()">
                </div>
                <div class="mt-2">
                    <label class="block text-sm font-medium text-gray-700">Tự học (giờ):</label>
                    <input type="number" id="selfStudyHours" min="0" value="0" class="mt-1 block w-1/12 border border-gray-300 rounded-md p-2" oninput="updateTable()">
                </div>
            </div>
            <p id="errorMessage" class="text-red-500 mt-2 hidden">Lỗi: Tổng tín chỉ không khớp hoặc tổng giờ không khớp với số tín chỉ (1 TC = 50 giờ)!</p>
        </div>

        <!-- Bảng phân bổ giờ -->
        <div>
            <h2 class="text-lg font-semibold mb-2">Phân bổ cụ thể</h2>
            <table class="min-w-full border-collapse border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="border border-gray-300 p-2 text-left">Phân bổ các loại giờ</th>
                        <th class="border border-gray-300 p-2 text-center">Lý thuyết</th>
                        <th class="border border-gray-300 p-2 text-center">TH/TN/TL</th>
                        <th class="border border-gray-300 p-2 text-center">Tự học, tự nghiên cứu</th>
                        <th class="border border-gray-300 p-2 text-center">Tổng</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="border border-gray-300 p-2 font-semibold" colspan="5">Số giờ giảng dạy trực diện, trực tuyến</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Trực diện (tại phòng học)</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="directTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="directPractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="directSelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="directTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Trực tuyến (đồng bộ hoặc không đồng bộ)</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="onlineTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="onlinePractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="onlineSelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="onlineTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">LMS (có hướng dẫn)</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="lmsGuideTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="lmsGuidePractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="lmsGuideSelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="lmsGuideTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Đi thực tế, trải nghiệm</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="fieldTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="fieldPractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="fieldSelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="fieldTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 font-semibold" colspan="5">Số giờ tự học và khác</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Tự học, tự nghiên cứu</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="selfStudyTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="selfStudyPractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="selfStudySelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="selfStudyTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Làm việc nhóm</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="groupTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="groupPractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="groupSelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="groupTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Hoạt động học tập trên LMS</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="lmsActivityTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="lmsActivityPractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="lmsActivitySelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="lmsActivityTotal">0</td>
                    </tr>
                    <tr>
                        <td class="border border-gray-300 p-2 pl-4">Ôn thi, dự thi, kiểm tra</td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="examTheory" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="examPractical" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center"><input type="number" id="examSelfStudy" min="0" value="0" class="w-20 border border-gray-300 rounded p-1" oninput="updateFromTable()"></td>
                        <td class="border border-gray-300 p-2 text-center" id="examTotal">0</td>
                    </tr>
                    <tr class="bg-gray-100 font-semibold">
                        <td class="border border-gray-300 p-2">Tổng</td>
                        <td class="border border-gray-300 p-2 text-center" id="totalTheory">0</td>
                        <td class="border border-gray-300 p-2 text-center" id="totalPractical">0</td>
                        <td class="border border-gray-300 p-2 text-center" id="totalSelfStudy">0</td>
                        <td class="border border-gray-300 p-2 text-center" id="totalAll">0</td>
                    </tr>
                </tbody>
            </table>
            <div class="mt-4 flex justify-center">
                <button onclick="downloadWord()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Tải file Word</button>
            </div>
        </div>
    </div>

    <script>
        // Hàm tính toán khi thay đổi ô nhập liệu trên cùng
        function updateTable() {
            // Lấy giá trị từ input
            const totalCredits = parseInt(document.getElementById('totalCredits').value) || 0;
            const theoryCredits = parseInt(document.getElementById('theoryCredits').value) || 0;
            const practicalCredits = parseInt(document.getElementById('practicalCredits').value) || 0;
            const selfStudyHours = parseInt(document.getElementById('selfStudyHours').value) || 0;

            // Tính toán số giờ theo quy định
            const theoryHours = theoryCredits * 15; // 15 giờ/tín chỉ lý thuyết (50 phút)
            const practicalHours = practicalCredits * 30; // 30 giờ/tín chỉ thực hành (50 phút)
            const totalHours = totalCredits * 50; // 50 giờ học tập định mức/tín chỉ (60 phút)

            // Kiểm tra ràng buộc
            const errorMessage = document.getElementById('errorMessage');
            if (theoryCredits + practicalCredits !== totalCredits) {
                errorMessage.classList.remove('hidden');
                errorMessage.textContent = `Lỗi: Tổng tín chỉ không khớp (${theoryCredits} + ${practicalCredits} ≠ ${totalCredits})!`;
                // Đặt giá trị mặc định trong bảng
                const fields = ['direct', 'online', 'lmsGuide', 'field', 'selfStudy', 'group', 'lmsActivity', 'exam'];
                fields.forEach(field => {
                    document.getElementById(`${field}Theory`).value = 0;
                    document.getElementById(`${field}Practical`).value = 0;
                    document.getElementById(`${field}SelfStudy`).value = 0;
                    document.getElementById(`${field}Total`).textContent = 0;
                });
                document.getElementById('totalTheory').textContent = 0;
                document.getElementById('totalPractical').textContent = 0;
                document.getElementById('totalSelfStudy').textContent = 0;
                document.getElementById('totalAll').textContent = 0;
                return;
            } else {
                errorMessage.classList.add('hidden');
            }

            // Phân bổ giờ (gợi ý)
            // Trực diện: Phân bổ toàn bộ giờ lý thuyết và thực hành
            document.getElementById('directTheory').value = theoryHours;
            document.getElementById('directPractical').value = practicalHours;
            document.getElementById('directSelfStudy').value = 0;

            // Trực tuyến: Phân bổ 0 giờ
            document.getElementById('onlineTheory').value = 0;
            document.getElementById('onlinePractical').value = 0;
            document.getElementById('onlineSelfStudy').value = 0;

            // LMS (có hướng dẫn): Phân bổ 0 giờ
            document.getElementById('lmsGuideTheory').value = 0;
            document.getElementById('lmsGuidePractical').value = 0;
            document.getElementById('lmsGuideSelfStudy').value = 0;

            // Đi thực tế: Dành cho thực hành, giả sử 0 giờ
            document.getElementById('fieldTheory').value = 0;
            document.getElementById('fieldPractical').value = 0;
            document.getElementById('fieldSelfStudy').value = 0;

            // Tự học, tự nghiên cứu: 60% giờ tự học
            document.getElementById('selfStudyTheory').value = 0;
            document.getElementById('selfStudyPractical').value = 0;
            document.getElementById('selfStudySelfStudy').value = Math.round(selfStudyHours * 0.6);

            // Làm việc nhóm: 10% giờ tự học
            document.getElementById('groupTheory').value = 0;
            document.getElementById('groupPractical').value = 0;
            document.getElementById('groupSelfStudy').value = Math.round(selfStudyHours * 0.1);

            // Hoạt động học tập trên LMS: 10% giờ tự học
            document.getElementById('lmsActivityTheory').value = 0;
            document.getElementById('lmsActivityPractical').value = 0;
            document.getElementById('lmsActivitySelfStudy').value = Math.round(selfStudyHours * 0.1);

            // Ôn thi, dự thi, kiểm tra: 20% giờ tự học
            document.getElementById('examTheory').value = 0;
            document.getElementById('examPractical').value = 0;
            const selfStudySelfStudy = parseInt(document.getElementById('selfStudySelfStudy').value) || 0;
            const groupSelfStudy = parseInt(document.getElementById('groupSelfStudy').value) || 0;
            const lmsActivitySelfStudy = parseInt(document.getElementById('lmsActivitySelfStudy').value) || 0;
            document.getElementById('examSelfStudy').value = selfStudyHours - selfStudySelfStudy - groupSelfStudy - lmsActivitySelfStudy;

            // Cập nhật tổng
            updateTotals();
        }

        // Hàm tính toán khi thay đổi giá trị trong bảng
        function updateFromTable() {
            // Lấy giá trị từ input
            const totalCredits = parseInt(document.getElementById('totalCredits').value) || 0;
            const theoryCredits = parseInt(document.getElementById('theoryCredits').value) || 0;
            const practicalCredits = parseInt(document.getElementById('practicalCredits').value) || 0;
            const selfStudyHours = parseInt(document.getElementById('selfStudyHours').value) || 0;

            // Tính toán số giờ theo quy định
            const theoryHours = theoryCredits * 15; // 15 giờ/tín chỉ lý thuyết (50 phút)
            const practicalHours = practicalCredits * 30; // 30 giờ/tín chỉ thực hành (50 phút)
            const totalHours = totalCredits * 50; // 50 giờ học tập định mức/tín chỉ (60 phút)

            // Lấy tất cả giá trị trong bảng
            const fields = ['direct', 'online', 'lmsGuide', 'field', 'selfStudy', 'group', 'lmsActivity', 'exam'];
            let totalTheory = 0;
            let totalPractical = 0;
            let totalSelfStudy = 0;

            fields.forEach(field => {
                const theory = parseInt(document.getElementById(`${field}Theory`).value) || 0;
                const practical = parseInt(document.getElementById(`${field}Practical`).value) || 0;
                const selfStudy = parseInt(document.getElementById(`${field}SelfStudy`).value) || 0;

                // Quy đổi cột Tổng: Lý thuyết và TH/TN/TL (50 phút) sang giờ 60 phút
                const total = (theory * 50 / 60) + (practical * 50 / 60) + selfStudy;
                document.getElementById(`${field}Total`).textContent = Math.round(total);

                totalTheory += theory;
                totalPractical += practical;
                totalSelfStudy += selfStudy;
            });

            // Cập nhật tổng
            document.getElementById('totalTheory').textContent = totalTheory;
            document.getElementById('totalPractical').textContent = totalPractical;
            document.getElementById('totalSelfStudy').textContent = totalSelfStudy;
            document.getElementById('totalAll').textContent = totalTheory + totalPractical + totalSelfStudy;

            // Kiểm tra ràng buộc
            const errorMessage = document.getElementById('errorMessage');
            const calculatedTotal = totalTheory + totalPractical + totalSelfStudy;
            if (theoryCredits + practicalCredits !== totalCredits || calculatedTotal !== totalHours) {
                errorMessage.classList.remove('hidden');
                errorMessage.textContent = `Lỗi: Tổng tín chỉ không khớp (${theoryCredits} + ${practicalCredits} ≠ ${totalCredits}) hoặc tổng giờ không khớp với số tín chỉ (1 TC = 50 giờ)! Tính được: ${calculatedTotal}, Nên là: ${totalHours}`;
            } else {
                errorMessage.classList.add('hidden');
            }
        }

        // Hàm tính tổng
        function updateTotals() {
            const fields = ['direct', 'online', 'lmsGuide', 'field', 'selfStudy', 'group', 'lmsActivity', 'exam'];
            let totalTheory = 0;
            let totalPractical = 0;
            let totalSelfStudy = 0;

            fields.forEach(field => {
                const theory = parseInt(document.getElementById(`${field}Theory`).value) || 0;
                const practical = parseInt(document.getElementById(`${field}Practical`).value) || 0;
                const selfStudy = parseInt(document.getElementById(`${field}SelfStudy`).value) || 0;

                // Quy đổi cột Tổng: Lý thuyết và TH/TN/TL (50 phút) sang giờ 60 phút
                const total = (theory * 50 / 60) + (practical * 50 / 60) + selfStudy;
                document.getElementById(`${field}Total`).textContent = Math.round(total);

                totalTheory += theory;
                totalPractical += practical;
                totalSelfStudy += selfStudy;
            });

            document.getElementById('totalTheory').textContent = totalTheory;
            document.getElementById('totalPractical').textContent = totalPractical;
            document.getElementById('totalSelfStudy').textContent = totalSelfStudy;
            document.getElementById('totalAll').textContent = totalTheory + totalPractical + totalSelfStudy;

            // Kiểm tra ràng buộc
            const totalCredits = parseInt(document.getElementById('totalCredits').value) || 0;
            const totalHours = totalCredits * 50;
            const errorMessage = document.getElementById('errorMessage');
            const calculatedTotal = totalTheory + totalPractical + totalSelfStudy;
            if (calculatedTotal !== totalHours) {
                errorMessage.classList.remove('hidden');
                errorMessage.textContent = `Lỗi: Tổng giờ không khớp với số tín chỉ (1 TC = 50 giờ)! Tính được: ${calculatedTotal}, Nên là: ${totalHours}`;
            } else {
                errorMessage.classList.add('hidden');
            }
        }

        // Hàm tải file Word
        function downloadWord() {
            // Kiểm tra lỗi từ bảng
            const errorMessage = document.getElementById('errorMessage');
            if (!errorMessage.classList.contains('hidden')) {
                alert("Vui lòng sửa lỗi trong bảng trước khi tải file Word!");
                return;
            }

            const htmlContent = `
                <html>
                    <head>
                        <meta charset="UTF-8">
                        <style>
                            body { font-family: 'Times New Roman', sans-serif; }
                            h1 { font-size: 24px; font-weight: bold; text-align: center; }
                            table { width: 100%; border-collapse: collapse; }
                            th, td { border: 1px solid black; padding: 8px; text-align: left; }
                            th { background-color: #f2f2f2; text-align: center; }
                            .total-row td { font-weight: bold; }
                        </style>
                    </head>
                    <body>
                        <h1>Phân Bổ Các Loại Giờ</h1>
                        <p>Số tín chỉ: ${document.getElementById('totalCredits').value || 0}, trong đó: Lý thuyết: ${document.getElementById('theoryCredits').value || 0} TC, TH/TN/TL: ${document.getElementById('practicalCredits').value || 0} TC, Tự học: ${document.getElementById('selfStudyHours').value || 0} giờ</p>
                        <table>
                            <thead>
                                <tr>
                                    <th>Phân bổ các loại giờ</th>
                                    <th>Lý thuyết</th>
                                    <th>TH/TN/TL</th>
                                    <th>Tự học, tự nghiên cứu</th>
                                    <th>Tổng</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td colspan="5" class="font-semibold">Số giờ giảng dạy trực diện, trực tuyến</td></tr>
                                <tr><td>Trực diện (tại phòng học)</td><td>${document.getElementById('directTheory').value || 0}</td><td>${document.getElementById('directPractical').value || 0}</td><td>${document.getElementById('directSelfStudy').value || 0}</td><td>${document.getElementById('directTotal').textContent || 0}</td></tr>
                                <tr><td>Trực tuyến (đồng bộ hoặc không đồng bộ)</td><td>${document.getElementById('onlineTheory').value || 0}</td><td>${document.getElementById('onlinePractical').value || 0}</td><td>${document.getElementById('onlineSelfStudy').value || 0}</td><td>${document.getElementById('onlineTotal').textContent || 0}</td></tr>
                                <tr><td>LMS (có hướng dẫn)</td><td>${document.getElementById('lmsGuideTheory').value || 0}</td><td>${document.getElementById('lmsGuidePractical').value || 0}</td><td>${document.getElementById('lmsGuideSelfStudy').value || 0}</td><td>${document.getElementById('lmsGuideTotal').textContent || 0}</td></tr>
                                <tr><td>Đi thực tế, trải nghiệm</td><td>${document.getElementById('fieldTheory').value || 0}</td><td>${document.getElementById('fieldPractical').value || 0}</td><td>${document.getElementById('fieldSelfStudy').value || 0}</td><td>${document.getElementById('fieldTotal').textContent || 0}</td></tr>
                                <tr><td colspan="5" class="font-semibold">Số giờ tự học và khác</td></tr>
                                <tr><td>Tự học, tự nghiên cứu</td><td>${document.getElementById('selfStudyTheory').value || 0}</td><td>${document.getElementById('selfStudyPractical').value || 0}</td><td>${document.getElementById('selfStudySelfStudy').value || 0}</td><td>${document.getElementById('selfStudyTotal').textContent || 0}</td></tr>
                                <tr><td>Làm việc nhóm</td><td>${document.getElementById('groupTheory').value || 0}</td><td>${document.getElementById('groupPractical').value || 0}</td><td>${document.getElementById('groupSelfStudy').value || 0}</td><td>${document.getElementById('groupTotal').textContent || 0}</td></tr>
                                <tr><td>Hoạt động học tập trên LMS</td><td>${document.getElementById('lmsActivityTheory').value || 0}</td><td>${document.getElementById('lmsActivityPractical').value || 0}</td><td>${document.getElementById('lmsActivitySelfStudy').value || 0}</td><td>${document.getElementById('lmsActivityTotal').textContent || 0}</td></tr>
                                <tr><td>Ôn thi, dự thi, kiểm tra</td><td>${document.getElementById('examTheory').value || 0}</td><td>${document.getElementById('examPractical').value || 0}</td><td>${document.getElementById('examSelfStudy').value || 0}</td><td>${document.getElementById('examTotal').textContent || 0}</td></tr>
                                <tr class="total-row"><td>Tổng</td><td>${document.getElementById('totalTheory').textContent || 0}</td><td>${document.getElementById('totalPractical').textContent || 0}</td><td>${document.getElementById('totalSelfStudy').textContent || 0}</td><td>${document.getElementById('totalAll').textContent || 0}</td></tr>
                            </tbody>
                        </table>
                    </body>
                </html>
            `;

            try {
                const converted = window.htmlDocx.asBlob(htmlContent);
                if (converted) {
                    saveAs(converted, "PhanBoCacLoaiGio.docx");
                    console.log("Tải file Word thành công!");
                    alert("File Word đã được tải thành công!");
                } else {
                    throw new Error("Không thể tạo file Word.");
                }
            } catch (error) {
                console.error("Lỗi trong hàm downloadWord:", error);
                alert("Có lỗi xảy ra khi tạo file Word. Vui lòng kiểm tra Console để biết chi tiết: " + error.message);
            }
        }

        // Khởi tạo bảng khi tải trang
        window.onload = updateTable;
    </script>
</body>
</html>